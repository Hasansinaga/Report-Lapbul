{% include 'lapbul_app/header.html' %}
<div id="layoutSidenav_content">
  <main>
    <div class="container-fluid px-4">
      <h5 class="mt-4">Form 1600 - Daftar Penyertaan Modal</h5>
      <hr />
      <a href="{% url 'lapbul_app:lapbul' %}" class="btn btn-secondary"
        >Kembali</a
      >
      <button
        type="button"
        class="btn btn-secondary tambah"
        data-bs-toggle="modal"
        data-bs-target="#form1600Modal"
      >
        Tambah
      </button>
      <br /><br />

      <!-- Table -->
      <table
        id="datatables"
        class="table table-bordered table-striped nowrap w-100"
      >
        <thead>
          <tr class="text-center align-middle">
            <th>Sandi Kantor</th>
            <th>Nomor Rekening</th>
            <th>ID Pihak Lawan</th>
            <th>Jenis</th>
            <th>Tanggal Mulai</th>
            <th>Tanggal Jatuh Tempo</th>
            <th>Suku Bunga</th>
            <th>Nominal</th>
            <th>Cadangan Kerugian Penurunan Nilai</th>
            <th>Cadangan Kerugian Penurunan Nilai Aset Baik</th>
            <th>Cadangan Kerugian Penurunan Nilai Aset Kurang Baik</th>
            <th>Cadangan Kerugian Penurunan Nilai Aset Tidak Baik</th>
            <th>Klasifikasi Aset Keuangan</th>
            <th>Jenis CKPN</th>
            <th>Aksi</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <!-- kolom identitas (tidak bisa diedit) -->
            <td>001</td>
            <td>1</td>
            <td>1</td>
            <td>1 (Biaya Perolehan)</td>
            <td>1 (Lancar)</td>
            <td>1 (Lancar)</td>
            <td>20240505</td>

            <!-- kolom nominal (bisa diedit) -->
            <td contenteditable="true">70.00</td>
            <td contenteditable="true">10000</td>
            <td contenteditable="true">1</td>
            <td contenteditable="true">1000</td>
            <td contenteditable="true">1000</td>
            <td contenteditable="true">1000</td>
            <td contenteditable="true">1000</td>

            <!-- aksi -->
            <td class="text-center">
              <a href="#" class="text-danger delete">
                <i class="fas fa-trash-alt"></i>
              </a>
            </td>
          </tr>
        </tbody>
      </table>

      <script>
        $(document).ready(function () {
          $("#datatables").DataTable({
            scrollX: true,
            responsive: true,
          });

          // Event untuk deteksi perubahan nilai nominal
          $("#datatables tbody").on(
            "blur",
            "td[contenteditable=true]",
            function () {
              let newValue = $(this).text();
              let column = $("#datatables thead th").eq($(this).index()).text();
              console.log("Kolom:", column, "-> Nilai baru:", newValue);

              // TODO: AJAX update ke server kalau perlu simpan otomatis
            }
          );
        });
      </script>
      {% include 'lapbul_app/footer.html' %}
    </div>
  </main>
</div>
